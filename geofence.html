<!DOCTYPE html>
<html>
<head>
  <title>gmaps.geofences test</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style type="text/css">
    body {
      font-family: sans-serif;
    }

    h1, h2, h3, h4, h5, h6 {
      margin: 0;
      font-weight: lighter;
      text-transform: lowercase;
      font-variant: small-caps;
    }

    .map,
    .panorama {
      width: 90%;
      height: 200px;
      margin: 20px auto;
    }

    .with-columns {
      display: block;
      width: 90%;
      overflow: hidden;
    }

    .with-columns .map,
    .with-columns .panorama {
      display: block;
      width: 50%;
      height: 200px;
      float: left;
    }
  </style>
</head>
<body>


<div id="map" style="background:purple;width:400px;height:300px;"></div>

  <script>

    var citymap = {
        vancouver: {
          center: {lat: 49.25, lng: -123.1},
          population: 6035020
        }
      };

      function initMap() {
        // Create the map.
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 5,
          center: {lat: 49.25, lng: -123.1},
          mapTypeId: 'terrain'
        });

        // Construct the circle for each value in citymap.
        // Note: We scale the area of the circle based on the population.
        // Add the circle for this city to the map.
        var cityCircle = new google.maps.Circle({
          strokeColor: '#FF0000',
          strokeOpacity: 0.8,
          strokeWeight: 2.5,
          fillColor: '#FF0000',
          fillOpacity: 0.45,
          map: map,
          center: citymap['vancouver'].center,
          radius: Math.sqrt(citymap['vancouver'].population) * 161
        });

        var cityCircleYellow = new google.maps.Circle({
          strokeColor: '#FF0000',
          strokeOpacity: 0.75,
          strokeWeight: 1.5,
          fillColor: '#FFFF00',
          fillOpacity: 0.35,
          map: map,
          center: citymap['vancouver'].center,
          radius: Math.sqrt(citymap['vancouver'].population) * 181
        });
      
        var path = [
          {lat: -12.040397656836609, lng: -77.03373871559225},
          {lat: -12.040248585302038, lng: -77.03993927003302},
          {lat: -12.050047116528843, lng: -77.02448169303511},
          {lat: -12.044804866577001, lng: -77.02154422636042},
        ];

        var polygon = new google.maps.Polygon({
          paths: path,
          map: map
        });


        var markerLoc = {lat: 37.090, lng: -95.712}
        var markerLoc2 = {lat: 52.25, lng: -120.1} // vancouver, for testing cirlce

        var marker = new google.maps.Marker({
          position: markerLoc,
          map: map,
          title: 'newpos'
        });

      var marker2 = new google.maps.Marker({
          position: markerLoc2,
          map: map,
          title: 'newpos'
        });

        // TO CHECK IF INSIDE POLYGON..
        //alert (google.maps.geometry.poly.containsLocation(marker.getPosition(), cityCircle))


        // Custom `contains` function to detect inside Circle
        google.maps.Circle.prototype.contains = function(latLng) {
          return this.getBounds().contains(latLng) && google.maps.geometry.spherical.computeDistanceBetween(this.getCenter(), latLng) <= this.getRadius();
        }

        alert(cityCircle.contains(marker2.getPosition()))
      }
    

  </script>
  <script src="http://maps.google.com/maps/api/js?key=AIzaSyCox1lTCfhcQcrj9_92CjnN9KmtzEn4Z3c&callback=initMap&libraries=geometry" async defer></script>
  <!-- <script src="gmaps.core.js"></script>  
  <script src="gmaps.geofences.js"></script>
  -->

</body>
</html>